@model System.Data.DataTable

@using AD_Team10.ViewModels;
@{
    var report = ViewBag.report;
    //if (ViewBag.reqReport != null) { report = (RequisitionReport)ViewBag.reqReport; }
    //else if (ViewBag.orderReport != null) { report = (OrderReport)ViewBag.orderReport; }
    //else { report = null; }
    var diff = 0;
    if (ViewBag.diff != null) { diff = (int)ViewBag.diff; }
}

@if (report != null)
{
    <table border="1" cellpadding="5">
        <thead>
            <tr>
                @foreach (System.Data.DataColumn col in Model.Columns)
                {
                    <th>@col.Caption</th>
                }
            </tr>
        </thead>
        <tbody>

            @for (int j = 0; j < Model.Rows.Count; j++)
            {
                <tr>


                    @if (j % diff == 0)
                    {
                        <td rowspan="@diff">@Model.Rows[j].ItemArray[0].ToString()</td>
                    }

                    @for (int i = 1; i < Model.Rows[j].ItemArray.Length; i++)
                    {
                        <td>@Model.Rows[j].ItemArray[i].ToString()</td>
                    }
                </tr>
            }
        </tbody>
    </table>

    if (report.GetType() == typeof(RequisitionReport))
    {
        @Html.ActionLink("Download", "ExportReqDataTable", "Clerk", new { report = Json.Encode(report) }, null)

        <img src="@Url.Action("ShowRequisitionChart", new { report = Json.Encode(report), type = "Column", groupBy = "time"})" />

        <img src="@Url.Action("ShowRequisitionChart", new {  report = Json.Encode(report), type = "Line", groupBy = "time"})" />

        <img src="@Url.Action("ShowRequisitionChart", new {  report = Json.Encode(report), type = "StackedColumn", groupBy = "cat"})" />
    }

    if (report.GetType() == typeof(OrderReport))
    {
        @Html.ActionLink("Download", "ExportOrderDataTable", "Clerk", new { report = Json.Encode(report) }, null)

        <img src="@Url.Action("ShowOrderChart", new { report = Json.Encode(report), type = "Column", groupBy = "time"})" />

        <img src="@Url.Action("ShowOrderChart", new {  report = Json.Encode(report), type = "Line", groupBy = "time"})" />
    }
}




